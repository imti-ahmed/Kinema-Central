import { useTheme } from "./ThemeContext";
import { useAuth } from "./AuthContext";
import svgPaths from "../imports/svg-nv41en1uil";

type MainTab = 'global' | 'personal' | 'stats' | 'settings';

function Fi17500754() {
  return (
    <div className="relative shrink-0 size-[16.05px]" data-name="fi_17500754">
      <svg
        className="block size-full"
        fill="none"
        preserveAspectRatio="none"
        viewBox="0 0 17 17"
      >
        <g id="fi_17500754">
          <path
            d={svgPaths.p2329b900}
            fill="var(--fill-0, #555E77)"
            id="Vector"
          />
          <path
            d={svgPaths.p36017000}
            fill="var(--fill-0, #424C63)"
            id="Vector_2"
          />
          <path
            d={svgPaths.p3f7e1371}
            fill="var(--fill-0, #EFF3F9)"
            id="Vector_3"
          />
          <path
            d={svgPaths.pc225980}
            fill="var(--fill-0, #CFE0F3)"
            id="Vector_4"
          />
          <path
            d={svgPaths.p11f8f400}
            fill="var(--fill-0, #EFF3F9)"
            id="Vector_5"
          />
          <path
            d={svgPaths.p30714700}
            fill="var(--fill-0, #CFE0F3)"
            id="Vector_6"
          />
          <path
            d={svgPaths.p3b7189f0}
            fill="var(--fill-0, #555E77)"
            id="Vector_7"
          />
          <path
            d={svgPaths.p3a46f680}
            fill="var(--fill-0, #424C63)"
            id="Vector_8"
          />
          <path
            d={svgPaths.p11d5800}
            fill="var(--fill-0, #EFF3F9)"
            id="Vector_9"
          />
          <path
            d={svgPaths.p13f44880}
            fill="var(--fill-0, #CFE0F3)"
            id="Vector_10"
          />
          <path
            d={svgPaths.p1b283280}
            fill="var(--fill-0, #EFF3F9)"
            id="Vector_11"
          />
          <path
            d={svgPaths.p2d7fb1c0}
            fill="var(--fill-0, #CFE0F3)"
            id="Vector_12"
          />
          <g id="Group">
            <path
              d={svgPaths.p26828d80}
              fill="var(--fill-0, #08105E)"
              id="Vector_13"
            />
            <path
              d={svgPaths.p1c1fbfc0}
              fill="var(--fill-0, #08105E)"
              id="Vector_14"
            />
            <path
              d={svgPaths.p3b738b00}
              fill="var(--fill-0, #08105E)"
              id="Vector_15"
            />
          </g>
        </g>
      </svg>
    </div>
  );
}

function Frame1() {
  return (
    <div className="box-border content-stretch flex flex-row gap-2 items-center justify-center p-0 relative shrink-0">
      <Fi17500754 />
      <div
        className="font-['Archivo:SemiBold',_sans-serif] font-semibold leading-[0] relative shrink-0 text-[#df3b3b] text-[12px] text-left text-nowrap"
        style={{ fontVariationSettings: "'wdth' 100" }}
      >
        <p className="block leading-[normal] whitespace-pre">
          Kinema Central 1.0.0
        </p>
      </div>
    </div>
  );
}

function Frame11() {
  return (
    <div className="box-border content-stretch flex flex-row gap-[74px] items-center justify-start p-0 relative shrink-0">
      <Frame1 />
    </div>
  );
}

function GlobalIcon() {
  return (
    <div className="relative shrink-0 size-[18px]" data-name="Frame">
      <svg
        className="block size-full"
        fill="none"
        preserveAspectRatio="none"
        viewBox="0 0 18 18"
      >
        <g id="Frame">
          <path
            d={svgPaths.p3c32e380}
            fill="var(--fill-0, #DF3B3B)"
            id="Vector"
            opacity="0.2"
          />
          <path
            d={svgPaths.p28e31700}
            fill="var(--fill-0, #DF3B3B)"
            id="Vector_2"
          />
        </g>
      </svg>
    </div>
  );
}

function PersonalIcon() {
  return (
    <div className="relative shrink-0 size-[18px]" data-name="Frame">
      <svg
        className="block size-full"
        fill="none"
        preserveAspectRatio="none"
        viewBox="0 0 18 18"
      >
        <g id="Frame">
          <path
            d={svgPaths.p317fbd00}
            fill="var(--fill-0, #FFC0C0)"
            id="Vector"
            opacity="0.2"
          />
          <path
            d={svgPaths.p894ff80}
            fill="var(--fill-0, #FFC0C0)"
            id="Vector_2"
          />
        </g>
      </svg>
    </div>
  );
}

function StatsIcon() {
  return (
    <div className="relative shrink-0 size-4" data-name="Frame">
      <svg
        className="block size-full"
        fill="none"
        preserveAspectRatio="none"
        viewBox="0 0 16 16"
      >
        <g id="Frame">
          <path
            d="M13 2.5V13H9.5V2.5H13Z"
            fill="var(--fill-0, #FFC0C0)"
            id="Vector"
            opacity="0.2"
          />
          <path
            d={svgPaths.p36934e00}
            fill="var(--fill-0, #FFC0C0)"
            id="Vector_2"
          />
        </g>
      </svg>
    </div>
  );
}

function ReadMeIcon() {
  return (
    <div className="relative shrink-0 size-4" data-name="Frame">
      <svg
        className="block size-full"
        fill="none"
        preserveAspectRatio="none"
        viewBox="0 0 16 16"
      >
        <g id="Frame">
          <path
            d={svgPaths.pcc49800}
            fill="var(--fill-0, #FFC0C0)"
            id="Vector"
            opacity="0.2"
          />
          <path
            d={svgPaths.p2df11b00}
            fill="var(--fill-0, #FFC0C0)"
            id="Vector_2"
          />
        </g>
      </svg>
    </div>
  );
}

function ThemeIcon() {
  return (
    <div className="relative shrink-0 size-4" data-name="Frame">
      <svg
        className="block size-full"
        fill="none"
        preserveAspectRatio="none"
        viewBox="0 0 16 16"
      >
        <g id="Frame">
          <path
            d={svgPaths.p3b4ded00}
            fill="var(--fill-0, #DF3B3B)"
            id="Vector"
            opacity="0.2"
          />
          <path
            d={svgPaths.p39a61880}
            fill="var(--fill-0, #DF3B3B)"
            id="Vector_2"
          />
        </g>
      </svg>
    </div>
  );
}

function UserIcon() {
  return (
    <div className="relative shrink-0 size-[18px]" data-name="Frame">
      <svg
        className="block size-full"
        fill="none"
        preserveAspectRatio="none"
        viewBox="0 0 18 18"
      >
        <g id="Frame">
          <path
            d={svgPaths.p141e4800}
            fill="var(--fill-0, #DF3B3B)"
            id="Vector"
            opacity="0.2"
          />
          <path
            d={svgPaths.p2024b600}
            fill="var(--fill-0, #DF3B3B)"
            id="Vector_2"
          />
        </g>
      </svg>
    </div>
  );
}

export function Header({ activeMainTab, onMainTabChange }: { 
  activeMainTab: MainTab; 
  onMainTabChange: (tab: MainTab) => void;
}) {
  const { currentTheme, cycleTheme } = useTheme();
  const { user, profile, signOut, isAuthenticated } = useAuth();

  const handleAuthClick = async () => {
    if (isAuthenticated) {
      // Sign out the user
      const { error } = await signOut();
      if (error) {
        console.error('Error signing out:', error);
      }
    }
    // If not authenticated, the parent App component will show the login screen
  };

  return (
    <div className="relative w-full">
      <div className="absolute border-[#ffebeb] border-[0px_0px_1px] border-solid inset-0 pointer-events-none" />
      <div className="flex flex-row items-center relative w-full">
        <div className="max-w-7xl mx-auto box-border content-stretch flex flex-row items-center justify-between pb-[14px] pt-[21px] px-8 relative w-full pr-[0px] pl-[0px]">
          <Frame11 />
          <div className="box-border content-stretch flex flex-row gap-[18px] items-center justify-start p-0 relative shrink-0">
            {/* Global Tab */}
            <button
              onClick={() => onMainTabChange('global')}
              className="box-border content-stretch flex flex-row gap-2 items-center justify-center p-0 relative shrink-0 hover:opacity-70 transition-all"
            >
              <GlobalIcon />
              <div
                className={`font-['Archivo:SemiBold',_sans-serif] font-semibold leading-[0] relative shrink-0 text-[12px] text-left text-nowrap ${
                  activeMainTab === 'global' ? 'text-[#df3b3b]' : 'text-[#ffc0c0]'
                }`}
                style={{ fontVariationSettings: "'wdth' 100" }}
              >
                <p className="block leading-[normal] whitespace-pre">Global</p>
              </div>
            </button>

            {/* Personal Tab */}
            <button
              onClick={() => onMainTabChange('personal')}
              className="box-border content-stretch flex flex-row gap-2 items-center justify-center p-0 relative shrink-0 hover:opacity-70 transition-all"
            >
              <PersonalIcon />
              <div
                className={`font-['Archivo:SemiBold',_sans-serif] font-semibold leading-[0] relative shrink-0 text-[12px] text-left text-nowrap ${
                  activeMainTab === 'personal' ? 'text-[#df3b3b]' : 'text-[#ffc0c0]'
                }`}
                style={{ fontVariationSettings: "'wdth' 100" }}
              >
                <p className="block leading-[normal] whitespace-pre">Personal</p>
              </div>
            </button>

            {/* Separator */}
            <div className="h-[10.277px] relative shrink-0 w-0">
              <div className="absolute bottom-0 left-[-0.5px] right-[-0.5px] top-0">
                <svg
                  className="block size-full"
                  fill="none"
                  preserveAspectRatio="none"
                  viewBox="0 0 2 11"
                >
                  <path
                    d="M1 0V10.2774"
                    id="Vector 1"
                    stroke="var(--stroke-0, #DF3B3B)"
                  />
                </svg>
              </div>
            </div>

            {/* Stats Tab */}
            <button
              onClick={() => onMainTabChange('stats')}
              className="box-border content-stretch flex flex-row gap-2 items-center justify-center p-0 relative shrink-0 hover:opacity-70 transition-all"
            >
              <StatsIcon />
              <div
                className={`font-['Archivo:SemiBold',_sans-serif] font-semibold leading-[0] relative shrink-0 text-[12px] text-left text-nowrap ${
                  activeMainTab === 'stats' ? 'text-[#df3b3b]' : 'text-[#ffc0c0]'
                }`}
                style={{ fontVariationSettings: "'wdth' 100" }}
              >
                <p className="block leading-[normal] whitespace-pre">Stats</p>
              </div>
            </button>

            {/* Read Me Tab */}
            <button
              onClick={() => onMainTabChange('settings')}
              className="box-border content-stretch flex flex-row gap-2 items-center justify-center p-0 relative shrink-0 hover:opacity-70 transition-all"
            >
              <ReadMeIcon />
              <div
                className={`font-['Archivo:SemiBold',_sans-serif] font-semibold leading-[0] relative shrink-0 text-[12px] text-left text-nowrap ${
                  activeMainTab === 'settings' ? 'text-[#df3b3b]' : 'text-[#ffc0c0]'
                }`}
                style={{ fontVariationSettings: "'wdth' 100" }}
              >
                <p className="block leading-[normal] whitespace-pre">Read Me</p>
              </div>
            </button>

            {/* Separator */}
            <div className="h-[10.277px] relative shrink-0 w-0">
              <div className="absolute bottom-0 left-[-0.5px] right-[-0.5px] top-0">
                <svg
                  className="block size-full"
                  fill="none"
                  preserveAspectRatio="none"
                  viewBox="0 0 2 11"
                >
                  <path
                    d="M1 0V10.2774"
                    id="Vector 1"
                    stroke="var(--stroke-0, #DF3B3B)"
                  />
                </svg>
              </div>
            </div>

            {/* Theme Switcher */}
            <button
              onClick={cycleTheme}
              className="box-border content-stretch flex flex-row gap-2 items-center justify-center p-0 relative shrink-0 hover:opacity-70 transition-all"
            >
              <ThemeIcon />
              <div
                className="font-['Archivo:SemiBold',_sans-serif] font-semibold leading-[0] relative shrink-0 text-[#df3b3b] text-[12px] text-left text-nowrap"
                style={{ fontVariationSettings: "'wdth' 100" }}
              >
                <p className="block leading-[normal] whitespace-pre">Red Theme</p>
              </div>
            </button>

            {/* User Section */}
            <button
              onClick={handleAuthClick}
              className="box-border content-stretch flex flex-row gap-2 items-center justify-center p-0 relative shrink-0 hover:opacity-70 transition-all"
            >
              <UserIcon />
              <div
                className="font-['Archivo:SemiBold',_sans-serif] font-semibold leading-[0] relative shrink-0 text-[#df3b3b] text-[12px] text-left text-nowrap"
                style={{ fontVariationSettings: "'wdth' 100" }}
              >
                <p className="block leading-[normal] whitespace-pre">
                  {isAuthenticated ? `Heyo, ${profile?.username || user?.user_metadata?.username || user?.email?.split('@')[0] || 'User'}` : 'Yar, Login Here'}
                </p>
              </div>
            </button>
          </div>
        </div>
      </div>
    </div>
  );
}